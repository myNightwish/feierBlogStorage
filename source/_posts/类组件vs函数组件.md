---
layout: post
title: 类组件vs函数组件
categories: React&&Vue
tags:
  - 函数组件
  - 类组件
description: 类组件、函数组件的pk对比
cover: https://cdn.jsdelivr.net/gh/myNightwish/CDN_res/img/react1.webp
copyright_author: 飞儿
copyright_url: 'https://www.nesxc.com/post/hexocc.html'
license: CC BY-NC-SA 4.0
license_url: 'https://creativecommons.org/licenses/by-nc-sa/4.0/'
abbrlink: React's Component
date: 2022-03-30 15:00:32
---

## 函数组件VS类组件

### 1、类组件

基于ES6的写法，通过继承React.component的组件

#### 1.1 类组件的优势

类组件是一个**面向对象编程思想**的一种表现。

> 而面向对象的特性之一：
>
> - 封装：将一类属性和方法聚合到一个class中
> - 继承：新的class可以通过继承现有class，实现对某一类属性和方法的复用；

so，类组件内部只通过继承React.component，就轻易获得了内部丰富的配备。

#### 1.2 类组件的的劣势：

* React.component提供了很多东西，学习成本更高，比如生命周期，用的不好也会让代码一团糟。大而全但心累。
* 开发者编写的逻辑在封装后，是和组件粘在一起的，这就使得类组件内部的逻辑难以实现拆分和复用。这就需要学习更高的设计模式，用更高的学习成本来交换一点编码的灵活度

### 2、函数组件

以函数的形态存在的组件，在**早期没有Hooks加持**时，函数组件内部无法定义、维护state，因此也叫**“无状态组件”**

#### 2.1 使用层面特性PK：

* 类组件继承自class，函数组件不需要；
* 类组件可以访问生命周期钩子，函数组件不可；
* 类组件可以获取实例化后的this，并基于该this做事情，但函数组件不可；
* 类组件可以定义并维护state状态，但函数组件不可；

#### 2.2 函数组件的优势

不仅能承担数据渲染（简单的任务），同样可以承担复杂的交互逻辑；

* 粗浅的认知：轻量、灵活、较低的学习成本
* **Dam（React开发者）：函数组件会捕获render内部的状态，这是两类组件最大的不同。**（如何理解这句话？）
* 类组件、函数组件之间的千差万别，但最不能被我们忽视的是，**心智模式层面的差异，**是**面向对象和函数式编程**这两种不同设计思想的差异

- **而函数式组件更加契合React的理念：**

  UI = f(data)，react组件本身的定位就是函数，吃进去数据，吐出来UI。开发者编写的是声明式的代码，而React就是把声明式的代码转换为命令式的DOM操作，把数据层面的描述映射到用户可见的UI变化中去。

  这就意味着react中数据和渲染是紧密绑在一起的，但类组件是做不到这一点。**为什么呢？**

  因为**函数组件会捕获render内部的状态，这是两类组件最大的不同。**

### 3、如何理解那句话？

**函数组件会捕获render内部的状态，这是两类组件最大不同**

#### 3.1 类组件

- **类组件中，虽然props不可变，但this是可变的，this上的数据是可以修改的**
  - this.props每次都可以获取最新的props，而这正是react获取数据实时性的重要手段。
  - 多数情况下，this.props与预期的渲染动作的连贯
  - 假如通过setTimeout将预期的渲染推迟了3s，打破了this.props和渲染动作之间的这种时机上的联动。也就是渲染时捕获到的是一个错误的props，这就出现了问题

- **而函数组件会捕获render内部的状态**
  - 在函数执行的一瞬间就被捕获，而props本身又是一个不可变值，因此在任何时机读取到的props都是最新的props。
  - 当父组件传递新的props时，其实内部产生了一次新的函数调用，并不会影响上一个props。
  - 函数组件是真正将数据与渲染绑定在了一起
- 总的来说，函数组件是一个**更加匹配其设计理念**、也**更有利于逻辑拆分和重用**的组件表达形式。

### 4、小结

通过本文对比，可以看出，在Hooks出现之前，类组件的**能力边界**明显强于函数组件（啥活都能干）。

但一味鼓吹轻量、易上手、取代类组件也不是应该讨论谁优谁劣的依据。更多的关注点，应该是二者的不同之处，把对应的场景与不同的特性结合起来。
